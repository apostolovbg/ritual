# RITUAL Backend

**Version 0.6b**

This repository contains the backend API for the RITUAL platform. The project follows a backend-first strategy. Previous design details from `AGENTS.json` have been folded into the documentation and the file has been removed.

## Setup

1. Create a virtual environment and install dependencies:

 ```bash
 python -m venv venv
 source venv/bin/activate
 pip install -r requirements.txt
 ```
2. Copy `.env.example` to `.env` and adjust values if needed. Only `DATABASE_URL` and `SECRET_KEY` are required when not using the defaults.

3. Run tests:

```bash
pytest -q
```

4. Start the development server:

```bash
uvicorn app.main:app --reload
```

## Environment Variables

Configuration values can be provided via environment variables or a `.env` file. Important keys:

- `DATABASE_URL` — SQLAlchemy database connection string
- `SECRET_KEY` — JWT signing secret
- `ALGORITHM` — token algorithm (default `HS256`)
- `ACCESS_TOKEN_EXPIRE_MINUTES` — token lifetime

## Web-Based Test Runner

A simple test runner is available under `test/index.html`. Serve the repository with Python's built-in web server and open the page in your browser:

```bash
python -m http.server
```

Then visit `http://localhost:8000/test/index.html` and click **Run Tests** to execute the suite using Pyodide.

## Docker Usage

The application can also run inside a container. Build the image and start the server with:

```bash
docker build -t ritual .
docker run --env-file .env -p 8000:8000 ritual
```

This is the recommended way to deploy the API on platforms such as Render or Railway.

## Documentation

- `AGENTS.md` contains development guidelines.
- `CHANGELOG.md` tracks project history.
- Interactive API documentation is auto-generated by FastAPI and available at `http://localhost:8000/docs` when the server is running.

## Endpoints

Phase 1 delivered user authentication. Phase 2 added event creation and booking requests. Main routes include:

- `POST /register` — create a user
- `POST /login` — obtain a JWT token
- `GET /me` — fetch the current user
- `PUT /me/profile` — update artist or club profile
- `POST /events` — create an event (club only)
- `GET /events` — list events
- `GET /events/{id}` — get a single event
- `POST /bookings` — request booking (artist only)
- `GET /my-bookings` — view bookings for the current user

## Development Roadmap

The project has progressed through the initial phases defined by the original design (formerly kept in `AGENTS.json`):

- **Phase 0** – Repository setup with documentation and tests.
- **Phase 1** – User registration, login and profile management.
- **Phase 2** – Event management and booking endpoints with tests.
- **Phase 3** – Deployment readiness with Docker and CI.

Version 0.6b introduces Docker support, CI automation, and environment variable management.
